<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${medico.id} != null ? 'Editar Médico' : 'Novo Médico'">Novo Médico</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; min-height: 100vh; }
        .form-container { max-width: 600px; margin: 2rem auto; padding: 0 1rem; }
        .form-card { background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1); overflow: hidden; animation: slideUp 0.6s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .form-header { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 2rem; text-align: center; position: relative; }
        .form-header h1 { margin:0; font-size:1.8rem; font-weight:600; }
        .form-header .subtitle { margin:0.5rem 0 0 0; opacity:0.9; font-size:1rem; }
        .form-body { padding: 2.5rem; }
        .form-floating { margin-bottom:1.5rem; position:relative; }
        .form-control { border:2px solid #e9ecef; border-radius:12px; padding:1.2rem 1rem 0.6rem; font-size:1rem; background:#f8f9fa; transition: all 0.3s ease; }
        .form-control:focus { border-color:#28a745; box-shadow:0 0 0 0.2rem rgba(40,167,69,0.25); background:white; transform:translateY(-2px); }
        .form-control.is-invalid { border-color:#dc3545; background:#fff5f5; }
        .form-floating label { color:#6c757d; font-weight:500; padding:1rem 1rem 0.6rem; }
        .invalid-feedback { display:block; color:#dc3545; font-size:0.875rem; margin-top:0.5rem; padding-left:1rem; }
        .btn-group-custom { display:flex; gap:1rem; margin-top:2rem; }
        .btn-primary-custom { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); border:none; padding:1rem 2rem; font-weight:600; border-radius:12px; color:white; flex:1; position:relative; overflow:hidden; }
        .btn-secondary-custom { background:#6c757d; border:none; padding:1rem 2rem; font-weight:600; border-radius:12px; color:white; text-decoration:none; display:inline-flex; justify-content:center; align-items:center; }
        .btn-secondary-custom:hover { background:#5a6268; transform:translateY(-2px); color:white; }
        .crm-help { font-size:0.8rem; color:#6c757d; margin-top:0.5rem; padding-left:1rem; }
    </style>
</head>
<body>
<div class="form-container">
    <div class="form-card">
        <div class="form-header">
            <h1><i class="fas fa-user-md me-2"></i><span th:text="${medico.id} != null ? 'Editar Médico' : 'Novo Médico'">Novo Médico</span></h1>
            <p class="subtitle" th:text="${medico.id} != null ? 'Atualize as informações do médico' : 'Cadastre um novo médico no sistema'">Cadastre um novo médico no sistema</p>
        </div>

        <div class="form-body">
            <!-- Mensagem de erro -->
            <div th:if="${error}" class="alert alert-danger" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                <span th:text="${error}">Erro</span>
            </div>

            <form th:action="@{${medico.id != null} ? '/medicos/atualizar/' + ${medico.id} : '/medicos/salvar'}"
                  th:object="${medico}" method="post" novalidate>

                <input type="hidden" th:field="*{id}">

                <!-- Nome -->
                <div class="form-floating">
                    <input type="text"
                           class="form-control"
                           id="nome"
                           th:field="*{nome}"
                           th:classappend="${#fields.hasErrors('nome')} ? 'is-invalid' : ''"
                           placeholder="Nome completo"
                           required>
                    <label for="nome"><i class="fas fa-user me-2"></i>Nome Completo</label>
                    <div th:if="${#fields.hasErrors('nome')}" class="invalid-feedback" th:errors="*{nome}"></div>
                </div>

                <!-- CRM -->
                <div class="form-floating">
                    <input type="text"
                           class="form-control"
                           id="crm"
                           th:field="*{crm}"
                           th:classappend="${#fields.hasErrors('crm')} ? 'is-invalid' : ''"
                           placeholder="CRM"
                           maxlength="5"
                           required>
                    <label for="crm"><i class="fas fa-id-card me-2"></i>CRM</label>
                    <div class="crm-help"><i class="fas fa-info-circle me-1"></i>Digite apenas números (ex: 12345)</div>
                    <div th:if="${#fields.hasErrors('crm')}" class="invalid-feedback" th:errors="*{crm}"></div>
                </div>

                <!-- Especialidade -->
                <div class="form-floating">
                    <input type="text"
                           class="form-control"
                           id="especialidade"
                           th:field="*{especialidade}"
                           th:classappend="${#fields.hasErrors('especialidade')} ? 'is-invalid' : ''"
                           placeholder="Especialidade"
                           required>
                    <label for="especialidade"><i class="fas fa-stethoscope me-2"></i>Especialidade</label>
                    <div th:if="${#fields.hasErrors('especialidade')}" class="invalid-feedback" th:errors="*{especialidade}"></div>
                </div>

                <!-- Botões -->
                <div class="btn-group-custom">
                    <button type="submit" class="btn-primary-custom"><i class="fas fa-save me-2"></i><span th:text="${medico.id} != null ? 'Atualizar' : 'Salvar'">Salvar</span></button>
                    <a th:href="@{/medicos}" class="btn-secondary-custom"><i class="fas fa-times me-2"></i>Cancelar</a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Máscara para CRM (apenas números, máximo 5 dígitos)
    const crmInput = document.getElementById('crm');
    crmInput.addEventListener('input', function() {
        this.value = this.value.replace(/\D/g, '').slice(0, 5);
    });

    // Foco automático no nome
    window.addEventListener('load', function() { document.getElementById('nome').focus(); });
</script>
</body>
</html>
